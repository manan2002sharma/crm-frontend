{"ast":null,"code":"import axios from \"axios\";\nconst rootUrl = \"http://localhost:3001/v1/\";\nconst loginUrl = rootUrl + \"user/login\";\nconst userProfileUrl = rootUrl + \"user\";\nconst logoutUrl = rootUrl + \"user/logout\";\nconst newAccessJWT = rootUrl + \"tokens\";\nexport const userLogin = frmData => {\n  return new Promise(async (resolve, reject) => {\n    try {\n      const res = await axios.post(loginUrl, frmData);\n      resolve(res.data);\n\n      if (res.data.status === \"success\") {\n        sessionStorage.setItem(\"accessJWT\", res.data.accessJWT);\n        localStorage.setItem(\"crmSite\", JSON.stringify({\n          refreshJWT: res.data.refreshJWT\n        }));\n      }\n    } catch (error) {\n      reject(error);\n    }\n  });\n};\nexport const fetchUser = () => {\n  return new Promise(async (resolve, reject) => {\n    try {\n      const accessJWT = sessionStorage.getItem(\"accessJWT\");\n\n      if (!accessJWT) {\n        reject(\"Token not found!\");\n      }\n\n      const res = await axios.get(userProfileUrl, {\n        headers: {\n          Authorization: accessJWT\n        }\n      });\n      resolve(res.data);\n    } catch (error) {\n      console.log(error);\n      reject(error.message);\n    }\n  });\n};\nexport const fetchNewAccessJWT = () => {\n  return new Promise(async (resolve, reject) => {\n    try {\n      const {\n        refreshJWT\n      } = JSON.parse(localStorage.getItem(\"crmSite\"));\n\n      if (!refreshJWT) {\n        reject(\"Token not found!\");\n      }\n\n      const res = await axios.get(newAccessJWT, {\n        headers: {\n          Authorization: refreshJWT\n        }\n      });\n\n      if (res.data.status === \"success\") {\n        sessionStorage.setItem(\"accessJWT\", res.data.accessJWT);\n      }\n\n      resolve(true);\n    } catch (error) {\n      if (error.message === \"Request failed with status code 403\") {\n        localStorage.removeItem(\"crmSite\");\n      }\n\n      reject(false);\n    }\n  });\n};\nexport const userLogout = async () => {\n  try {\n    await axios.delete(logoutUrl, {\n      headers: {\n        Authorization: sessionStorage.getItem(\"accessJWT\")\n      }\n    });\n  } catch (error) {\n    console.log(error);\n  }\n};","map":{"version":3,"sources":["C:/Users/Man/Downloads/Compressed/crm-ticket/crm-frontend-8674e752f8218131abd459f664a565932ab1519e/src/api/userApi.js"],"names":["axios","rootUrl","loginUrl","userProfileUrl","logoutUrl","newAccessJWT","userLogin","frmData","Promise","resolve","reject","res","post","data","status","sessionStorage","setItem","accessJWT","localStorage","JSON","stringify","refreshJWT","error","fetchUser","getItem","get","headers","Authorization","console","log","message","fetchNewAccessJWT","parse","removeItem","userLogout","delete"],"mappings":"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","sourcesContent":["import axios from \"axios\";\n\nconst rootUrl = \"http://localhost:3001/v1/\";\nconst loginUrl = rootUrl + \"user/login\";\nconst userProfileUrl = rootUrl + \"user\";\nconst logoutUrl = rootUrl + \"user/logout\";\nconst newAccessJWT = rootUrl + \"tokens\";\n\nexport const userLogin = (frmData) => {\n  return new Promise(async (resolve, reject) => {\n    try {\n      const res = await axios.post(loginUrl, frmData);\n\n      resolve(res.data);\n\n      if (res.data.status === \"success\") {\n        sessionStorage.setItem(\"accessJWT\", res.data.accessJWT);\n        localStorage.setItem(\n          \"crmSite\",\n          JSON.stringify({ refreshJWT: res.data.refreshJWT })\n        );\n      }\n    } catch (error) {\n      reject(error);\n    }\n  });\n};\n\nexport const fetchUser = () => {\n  return new Promise(async (resolve, reject) => {\n    try {\n      const accessJWT = sessionStorage.getItem(\"accessJWT\");\n\n      if (!accessJWT) {\n        reject(\"Token not found!\");\n      }\n\n      const res = await axios.get(userProfileUrl, {\n        headers: {\n          Authorization: accessJWT,\n        },\n      });\n\n      resolve(res.data);\n    } catch (error) {\n      console.log(error);\n      reject(error.message);\n    }\n  });\n};\n\nexport const fetchNewAccessJWT = () => {\n  return new Promise(async (resolve, reject) => {\n    try {\n      const { refreshJWT } = JSON.parse(localStorage.getItem(\"crmSite\"));\n\n      if (!refreshJWT) {\n        reject(\"Token not found!\");\n      }\n\n      const res = await axios.get(newAccessJWT, {\n        headers: {\n          Authorization: refreshJWT,\n        },\n      });\n\n      if (res.data.status === \"success\") {\n        sessionStorage.setItem(\"accessJWT\", res.data.accessJWT);\n      }\n\n      resolve(true);\n    } catch (error) {\n      if (error.message === \"Request failed with status code 403\") {\n        localStorage.removeItem(\"crmSite\");\n      }\n\n      reject(false);\n    }\n  });\n};\n\nexport const userLogout = async () => {\n  try {\n    await axios.delete(logoutUrl, {\n      headers: {\n        Authorization: sessionStorage.getItem(\"accessJWT\"),\n      },\n    });\n  } catch (error) {\n    console.log(error);\n  }\n};\n"]},"metadata":{},"sourceType":"module"}